---
title: "Explore response data"
output: 
  html_notebook:
    toc: yes
    toc_depth: 2
    toc_float: true
    theme: cerulean
---

```{r echo=FALSE, warning=FALSE, message=F}
suppressMessages(library(tidyverse))
suppressMessages(library(xtable))
suppressMessages(library(pheatmap))
suppressMessages(library(RColorBrewer))
suppressMessages(library(ggpubr))
```


```{r echo=F,warning=FALSE, message=FALSE}
load("../data/df.all.RData")
df <- df.all
```

Scale data by dataset mean and standard deviation

```{r echo=F,warning=FALSE, message=FALSE}
ggplot(df,aes(x=sample,y=scaled_value)) + geom_boxplot(outlier.shape=NA) + theme_classic()
```
```{r echo=F,warning=FALSE, message=FALSE}
ggplot(df,aes(x=dataset,y=scaled_value)) + geom_boxplot(outlier.shape=NA) + theme_classic()
```


```{r echo=F,warning=FALSE, message=FALSE}
plot_gene <- function(d,gene_of_interest){
  d %>% filter(Gene==gene_of_interest) %>% select(scaled_value,dataset,objective_response) %>%
  .[complete.cases(.),] %>%
  ggplot(aes(x=dataset,y=scaled_value,fill=objective_response)) +   geom_boxplot(outlier.shape = NA) + ggtitle(gene_of_interest) +
  geom_point(position=position_jitterdodge(0.1),shape=16,size=1) +
  theme_classic()
}
```


```{r echo=F,warning=FALSE, message=FALSE}
plot_gene(df,"CTLA4")
plot_gene(df,"PDCD1")
plot_gene(df,"CD274")
```


```{r echo=F,warning=FALSE, message=FALSE}
plot_gene_stats <- function (d,gene_of_interest){
  d %>% filter(Gene==gene_of_interest) %>% select(scaled_value,dataset,objective_response) %>% .[complete.cases(.),] %>% 
ggboxplot(x = "dataset", y = "scaled_value",
          add = "jitter",color="objective_response") + stat_compare_means(aes(group =objective_response),label = "p.format") +
    ggtitle(gene_of_interest)
}
```


```{r echo=F,warning=FALSE, message=FALSE}
plot_gene_stats(df,"CTLA4")
plot_gene_stats(df,"PDCD1")
plot_gene_stats(df,"CD274")
```


